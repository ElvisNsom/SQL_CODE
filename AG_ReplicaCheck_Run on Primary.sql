--	RUN ON PRIMARY REPLICA SERVERUSE [master]GOSET NOCOUNT ONdeclare @search_name varchar(255) = ''select 	  ag.[name] as [AG_Name]	, ar.[replica_server_name] as [Server_Name]	, case		when drs.[is_primary_replica] = 1		then 'PRIMARY'		else 'REPLICA'		end as [Server_Description]	, d.[name] as [Primary_DB_Name]	, drs.[synchronization_state_desc] as [Sync_State]	, drs.[synchronization_health_desc] as [AG_Health_State]	, drs.[database_state_desc] as [DB_State]	, drs.[suspend_reason_desc] as [Suspend_Reason]	, drs.[last_commit_time] as [Last_Commit_Time]	, drs.[secondary_lag_seconds] as [Lag_Seconds]from sys.availability_groups agjoin sys.dm_hadr_database_replica_states drs  on ag.[group_id] = drs.[group_id]join sys.databases d  on drs.[database_id] = d.[database_id]join sys.availability_replicas ar  on drs.[replica_id] = ar.[replica_id]where ag.[name] like '%' + @search_name + '%'order by ag.[name]	, case		when drs.[is_primary_replica] = 1		then 'PRIMARY'		else 'REPLICA'	
